---
layout: default
---

<!-- Product Detail Page -->
<div class="container py-5">
  <div class="row">
    <!-- Product Image -->
    <div class="col-lg-6 mb-4">
      {% if page.images %}
      <!-- Image Gallery Carousel -->
      <div id="productCarousel" class="carousel slide shadow rounded" data-bs-ride="carousel">
        <div class="carousel-indicators">
          {% for image in page.images %}
          <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="{{ forloop.index0 }}" {% if forloop.first %}class="active" aria-current="true"{% endif %} aria-label="Slide {{ forloop.index }}"></button>
          {% endfor %}
        </div>
        <div class="carousel-inner">
          {% for image in page.images %}
          <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <picture>
              <source srcset="{{ image | replace: '.jpeg', '.webp' | relative_url }}" type="image/webp">
              <img src="{{ image | relative_url }}"
                   class="d-block w-100 rounded"
                   alt="{{ page.title }} - Foto {{ forloop.index }}"
                   loading="{% if forloop.first %}eager{% else %}lazy{% endif %}"
                   style="max-height: 500px; object-fit: cover;">
            </picture>
          </div>
          {% endfor %}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      {% elsif page.image %}
      <!-- Single Image -->
      <div class="product-image-container">
        <picture>
          <source srcset="{{ page.image | replace: '.jpeg', '.webp' | relative_url }}" type="image/webp">
          <img src="{{ page.image | relative_url }}"
               class="img-fluid rounded shadow"
               alt="{{ page.title }}"
               loading="eager">
        </picture>
      </div>
      {% else %}
      <!-- No Image -->
      <div class="text-center p-5 bg-light rounded">
        <i class="bi bi-image" style="font-size: 8rem; color: #ccc;"></i>
        <p class="text-muted mt-3">Gambar produk akan segera ditambahkan</p>
      </div>
      {% endif %}
    </div>

    <!-- Product Info -->
    <div class="col-lg-6">
      <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{{ '/' | relative_url }}">Beranda</a></li>
          <li class="breadcrumb-item"><a href="{{ site.baseurl }}/#product">Produk</a></li>
          <li class="breadcrumb-item active">{{ page.title }}</li>
        </ol>
      </nav>

      <h1 class="display-5 fw-bold text-wood mb-3">{{ page.title }}</h1>

      {% if page.popular %}
      <span class="badge bg-warning text-dark mb-3"><i class="bi bi-star-fill me-1"></i> Produk Populer</span>
      {% endif %}

      <!-- Rating Display -->
      {% if page.rating %}
      <div class="product-rating mb-3">
        <span class="text-warning me-2">
          {% assign rating = page.rating %}
          {% for i in (1..5) %}
            {% if i <= rating %}
              <i class="bi bi-star-fill"></i>
            {% else %}
              <i class="bi bi-star"></i>
            {% endif %}
          {% endfor %}
        </span>
        <span class="text-muted">
          <strong>{{ page.rating }}/5</strong> ({{ page.review_count | default: 0 }} review)
        </span>
      </div>
      {% endif %}

      <div class="product-price-large mb-4">
        <span class="h2 text-wood fw-bold">Rp {{ page.price | rupiah }}</span>
        <p class="text-muted">per batang (4 meter)</p>
        <p class="small text-success"><i class="bi bi-check-circle-fill me-1"></i> Harga sudah termasuk ongkir</p>
      </div>

      <!-- Product Features -->
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <h5 class="text-wood mb-3"><i class="bi bi-info-circle me-2"></i>Spesifikasi</h5>
          <ul class="list-unstyled">
            <li class="mb-2"><strong>Diameter:</strong> {{ page.diameter }}</li>
            <li class="mb-2"><strong>Panjang:</strong> 4 meter</li>
            <li class="mb-2"><strong>Material:</strong> Kayu Gelam Asli</li>
            <li class="mb-2"><strong>SKU:</strong> {{ page.sku }}</li>
            <li class="mb-2"><strong>Stok:</strong> <span class="text-success">Ready Stock</span></li>
          </ul>
        </div>
      </div>

      <!-- Features List -->
      {% if page.features %}
      <div class="mb-4">
        <h5 class="text-wood mb-3">Keunggulan:</h5>
        <ul class="list-unstyled">
          {% for feature in page.features %}
          <li class="mb-2">
            <i class="bi bi-check-circle-fill text-success me-2"></i>{{ feature }}
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      <!-- CTA Buttons -->
      <div class="d-grid gap-2">
        <a href="https://wa.me/{{ site.business.whatsapp }}?text=Halo,%20saya%20ingin%20pesan%20{{ page.title }}%20-%20Rp%20{{ page.price }}"
           class="btn btn-success btn-lg"
           target="_blank">
          <i class="bi bi-whatsapp me-2"></i>Pesan via WhatsApp
        </a>
        <a href="tel:{{ site.business.phone }}" class="btn btn-outline-wood btn-lg">
          <i class="bi bi-telephone me-2"></i>Telepon Langsung
        </a>
      </div>
    </div>
  </div>

  <!-- Product Description -->
  {% if content != '' %}
  <div class="row mt-5">
    <div class="col-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-wood text-white">
          <h4 class="mb-0"><i class="bi bi-file-text me-2"></i>Deskripsi Produk</h4>
        </div>
        <div class="card-body p-4">
          <div class="product-description">
            {{ content }}
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Related Products -->
  {% include related-products-by-node-id.html %}

  <!-- Related Articles Section -->
  {% assign all_posts = site.posts | concat: site.post_with_product %}
  {% if all_posts.size > 0 %}
  <div class="row mt-5">
    <div class="col-12">
      {% include related-content-by-node-id.html title="Artikel Panduan & Tips" %}
    </div>
  </div>
  {% endif %}
</div>

<!-- Schema.org Product Markup -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Product",
      "name": "{{ page.title }}",
      "description": "{{ page.description | default: page.excerpt | strip_html | strip_newlines | truncate: 160 }}",
      {% if page.image %}
      "image": "{{ page.image | absolute_url }}",
      {% endif %}
      "sku": "{{ page.sku }}",
      "brand": {
        "@type": "Brand",
        "name": "{{ site.business.name }}"
      },
      "offers": {
        "@type": "Offer",
        "url": "{{ page.url | absolute_url }}",
        "priceCurrency": "IDR",
        "price": "{{ page.price }}",
        "priceValidUntil": "2025-12-31",
        "availability": "https://schema.org/InStock",
        "seller": {
          "@type": "Organization",
          "name": "{{ site.business.name }}"
        },
        "shippingDetails": {
          "@type": "OfferShippingDetails",
          "shippingRate": {
            "@type": "MonetaryAmount",
            "value": "0",
            "currency": "IDR"
          },
          "shippingDestination": {
            "@type": "DefinedRegion",
            "addressCountry": "ID"
          },
          "deliveryTime": {
            "@type": "ShippingDeliveryTime",
            "handlingTime": {
              "@type": "QuantitativeValue",
              "minValue": 1,
              "maxValue": 2,
              "unitCode": "DAY"
            },
            "transitTime": {
              "@type": "QuantitativeValue",
              "minValue": 3,
              "maxValue": 7,
              "unitCode": "DAY"
            }
          }
        },
        "hasMerchantReturnPolicy": {
          "@type": "MerchantReturnPolicy",
          "applicableCountry": "ID",
          "returnPolicyCategory": "https://schema.org/MerchantReturnFiniteReturnWindow",
          "merchantReturnDays": 7,
          "returnMethod": "https://schema.org/ReturnByMail",
          "returnFees": "https://schema.org/FreeReturn"
        }
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "{{ page.rating | default: 4.5 }}",
        "reviewCount": "{{ page.review_count | default: 45 }}",
        "bestRating": "5",
        "worstRating": "1"
      }
    },
    {
      "@type": "ItemList",
      "name": "Produk Lainnya",
      "itemListElement": [
        {% comment %} Node-based rotation for Schema.org - matches visual display {% endcomment %}
        {% assign current_product_index = 0 %}
        {% for prod in site.products %}
          {% if prod.url == page.url %}
            {% assign current_product_index = forloop.index0 %}
            {% break %}
          {% endif %}
        {% endfor %}

        {% assign sorted_products_schema = site.products | sort: "last_modified_at" | reverse %}
        {% assign product_count_schema = sorted_products_schema.size %}
        {% assign start_position_schema = current_product_index | modulo: product_count_schema %}

        {% assign schema_products = "" | split: "" %}
        {% assign schema_products_added = 0 %}
        {% assign schema_offset = 1 %}

        {% for i in (0..10) %}
          {% if schema_products_added >= 3 %}
            {% break %}
          {% endif %}

          {% assign target_index_schema = start_position_schema | plus: schema_offset | plus: i %}
          {% assign target_index_schema = target_index_schema | modulo: product_count_schema %}

          {% for product in sorted_products_schema %}
            {% if forloop.index0 == target_index_schema %}
              {% comment %} Skip current product {% endcomment %}
              {% if product.url != page.url %}
                {% assign schema_products = schema_products | push: product %}
                {% assign schema_products_added = schema_products_added | plus: 1 %}
              {% endif %}
              {% break %}
            {% endif %}
          {% endfor %}
        {% endfor %}

        {% for product in schema_products %}
        {
          "@type": "ListItem",
          "position": {{ forloop.index }},
          "item": {
            "@type": "Product",
            "name": "{{ product.title }}",
            "description": "{{ product.description | strip_html | strip_newlines | escape }}",
            "image": "{{ site.url }}{{ site.baseurl }}{{ product.image }}",
            "url": "{{ site.url }}{{ site.baseurl }}{{ product.url }}",
            "sku": "DOLKEN-{{ product.diameter | replace: ' ', '' | upcase }}",
            "brand": {
              "@type": "Brand",
              "name": "{{ site.business.name }}"
            },
            "offers": {
              "@type": "Offer",
              "price": "{{ product.price }}",
              "priceCurrency": "IDR",
              "availability": "https://schema.org/InStock",
              "url": "{{ site.url }}{{ site.baseurl }}{{ product.url }}",
              "priceValidUntil": "{{ 'now' | date: '%Y' | plus: 1 }}-12-31",
              "seller": {
                "@type": "Organization",
                "name": "{{ site.business.name }}"
              },
              "shippingDetails": {
                "@type": "OfferShippingDetails",
                "shippingRate": {
                  "@type": "MonetaryAmount",
                  "value": "0",
                  "currency": "IDR"
                },
                "shippingDestination": {
                  "@type": "DefinedRegion",
                  "addressCountry": "ID"
                },
                "deliveryTime": {
                  "@type": "ShippingDeliveryTime",
                  "handlingTime": {
                    "@type": "QuantitativeValue",
                    "minValue": 1,
                    "maxValue": 2,
                    "unitCode": "DAY"
                  },
                  "transitTime": {
                    "@type": "QuantitativeValue",
                    "minValue": 3,
                    "maxValue": 7,
                    "unitCode": "DAY"
                  }
                }
              },
              "hasMerchantReturnPolicy": {
                "@type": "MerchantReturnPolicy",
                "applicableCountry": "ID",
                "returnPolicyCategory": "https://schema.org/MerchantReturnFiniteReturnWindow",
                "merchantReturnDays": 7,
                "returnMethod": "https://schema.org/ReturnByMail",
                "returnFees": "https://schema.org/FreeReturn"
              }
            },
            "aggregateRating": {
              "@type": "AggregateRating",
              "ratingValue": "{% if product.popular %}4.8{% else %}4.5{% endif %}",
              "reviewCount": "{% if product.popular %}127{% else %}45{% endif %}",
              "bestRating": "5",
              "worstRating": "1"
            }
          }
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    }
  ]
}
</script>

<!-- Carousel Initialization Script -->
{% if page.images %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  var carouselElement = document.getElementById('productCarousel');
  if (carouselElement && typeof bootstrap !== 'undefined') {
    // Initialize carousel manually
    var carousel = new bootstrap.Carousel(carouselElement, {
      interval: 3000,
      ride: 'carousel',
      pause: 'hover',
      wrap: true,
      keyboard: true,
      touch: true
    });
  }
});
</script>
{% endif %}
