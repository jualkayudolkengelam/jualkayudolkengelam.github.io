{% comment %}
  ============================================================================
  Tutorial Content Section Block Component
  ============================================================================

  @file        _includes/posts/tutorial/block--content-section.html
  @description Main content section with strict H2→3×H3→3×H4 hierarchy
  @version     1.0.0
  @date        2025-11-20
  @author      arisciwek

  Features:
  ---------
  - H2: Section title with gradient card header
  - 1 intro paragraph after H2
  - H3: Overview section (optional)
  - EXACTLY 3 cards (H3 level)
  - Each card has:
    - H3 title with icon
    - EXACTLY 2 paragraphs
    - EXACTLY 3 H4 details (each with 1 paragraph)
  - CSS selector support (id, css_class)
  - Responsive 3-column grid (col-md-4)
  - Bootstrap 5 cards with hover effects

  Parameters:
  -----------
  - section.id: Unique section ID (optional)
  - section.css_class: Custom CSS classes (optional)
  - section.title: H2 section title
  - section.intro: 1 intro paragraph (REQUIRED)
  - section.icon: Bootstrap icon for H2 header
  - section.gradient: Color theme (primary, info, warning, success, danger, wood)
  - section.overview: Overview object (optional)
    - title: H3 overview title
    - subtitle: Small description
    - icon: Bootstrap icon
    - color: Bootstrap color
  - section.cards: Array of exactly 3 card objects
    - id: Card ID (optional)
    - css_class: Custom classes (optional)
    - title: H3 card title
    - icon: Bootstrap icon
    - color: Bootstrap color
    - paragraphs: Array of exactly 2 paragraphs
    - details: Array of exactly 3 H4 objects
      - id: Detail ID (optional)
      - css_class: Custom classes (optional)
      - h4: H4 title
      - paragraph: 1 paragraph content

  Usage:
  ------
  See TEMPLATE--post-tutorial.md for complete example

  In content:
  {% include posts/tutorial/block--content-section.html section=section %}

  ============================================================================
{% endcomment %}

{% comment %} Gradient color mapping {% endcomment %}
{% if section.gradient == "primary" %}
  {% assign gradient = "linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%)" %}
{% elsif section.gradient == "info" %}
  {% assign gradient = "linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%)" %}
{% elsif section.gradient == "warning" %}
  {% assign gradient = "linear-gradient(135deg, #f59e0b 0%, #d97706 50%, #b45309 100%)" %}
{% elsif section.gradient == "success" %}
  {% assign gradient = "linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)" %}
{% elsif section.gradient == "danger" %}
  {% assign gradient = "linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%)" %}
{% elsif section.gradient == "wood" %}
  {% assign gradient = "linear-gradient(135deg, #8b5a3c 0%, #6d4c41 50%, #5d4037 100%)" %}
{% else %}
  {% assign gradient = "linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%)" %}
{% endif %}

{% if data %}
  {% assign section = data.section %}
{% elsif item %}
  {% assign section = item.section %}
{% elsif section %}
  {% comment %}section already passed{% endcomment %}
{% else %}
  <!-- ERROR: Neither data, item, nor section parameter provided -->
{% endif %}


<!-- H2: Main Section Header -->
<div class="my-5 content-section-header-wrapper">
  <div class="card border-0 content-section-header-card shadow-lg">
    <div class="card-body text-white text-center py-4 px-3" style="background: {{ gradient }};">
      <i class="{{ section.icon }} mb-2 fs-2-5rem"></i>
      <h2 class="h2 mb-0 fw-bold text-white">{{ section.title }}</h2>
      {% if section.intro %}
      <p class="mb-0 mt-3 lead" style="opacity: 0.95;">{{ section.intro }}</p>
      {% endif %}
    </div>
  </div>
</div>

<!-- H3: Overview Section (Optional) -->
{% if section.overview %}
<div class="my-4 content-section-overview-wrapper">
  <div id="{{ section.overview.id | default: '' }}" class="d-flex align-items-center mb-3 content-section-overview-card bg-{{ section.overview.color | default: 'primary' }} bg-opacity-10 px-3 py-2 rounded-3 {{ section.overview.css_class | default: '' }}">
    <div class="flex-grow-1">
      <h3 class="h4 mb-0 text-wood fw-bold">
        <i class="{{ section.overview.icon }} text-{{ section.overview.color | default: 'primary' }} me-2"></i>{{ section.overview.title }}
      </h3>
      {% if section.overview.subtitle %}
      <p class="small text-muted mb-0 mt-1">{{ section.overview.subtitle }}</p>
      {% endif %}
    </div>
  </div>
</div>
{% endif %}

<!-- Cards: EXACTLY 3 Cards (H3 Level) -->
{% if section.cards %}
<div class="row g-3 my-4 content-section-cards-grid">
  {% for card in section.cards %}
  <div class="col-12 col-sm-6 col-lg-4 content-section-card-col">
    <div id="{{ card.id | default: '' }}" class="card border-0 content-section-card shadow-sm h-100 hover-lift {{ card.css_class | default: '' }}">
      <div class="card-body">

        <!-- H3: Card Title with Icon -->
        <div class="d-flex align-items-start mb-3 content-section-card-header">
          <div class="bg-{{ card.color | default: 'primary' }} bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center flex-shrink-0 me-3" style="width: 50px; height: 50px;">
            <i class="{{ card.icon }} text-{{ card.color | default: 'primary' }}" style="font-size: 1.5rem;"></i>
          </div>
          <div class="flex-grow-1">
            <h3 class="h5 text-wood mb-0 fw-bold">{{ card.title }}</h3>
          </div>
        </div>

        <!-- Card Paragraphs: EXACTLY 2 -->
        {% if card.paragraphs %}
        <div class="content-section-card-paragraphs">
          {% for para in card.paragraphs %}
          <p class="text-muted content-section-card-para {% if forloop.last %}mb-3{% else %}mb-2{% endif %}">{{ para }}</p>
          {% endfor %}
        </div>
        {% endif %}

        <!-- H4: Details (EXACTLY 3) -->
        {% if card.details %}
        <div class="mt-3 content-section-card-details">
          {% for detail in card.details %}
          <div id="{{ detail.id | default: '' }}" class="mb-3 content-section-card-detail-item {{ detail.css_class | default: '' }} {% unless forloop.last %}pb-3 border-bottom{% endunless %}">
            <h4 class="h6 fw-bold text-wood mb-2">
              <i class="bi bi-arrow-right-circle text-{{ card.color | default: 'primary' }} me-2"></i>{{ detail.h4 }}
            </h4>
            <p class="small text-muted mb-0">{{ detail.paragraph }}</p>
          </div>
          {% endfor %}
        </div>
        {% endif %}

      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endif %}

<style>
.hover-lift {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.hover-lift:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
}
.fs-2-5rem {
  font-size: 2.5rem;
}
</style>
