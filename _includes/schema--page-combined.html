{% comment %}
============================================================================
Combined Schema: Global + Page in Single @graph
============================================================================

@file        schema--page-combined.html
@path        _includes/schema--page-combined.html
@type        Schema (combined component)
@description All schemas in single @graph for better Google recognition
@author      arisciwek

This combines WebSite, Organization, SiteNavigationElement, and Page
schemas into a single @graph for optimal Google Rich Results detection.

Parameters:
-----------
- type: (optional) WebPage type variant (default: "WebPage")
  Options: "WebPage", "AboutPage", "ContactPage", "CollectionPage"

Usage:
------
In page layouts (replace schema--global + schema--page):
{% include schema--page-combined.html type="AboutPage" %}

Benefits:
---------
- All schemas in single @graph (Google best practice)
- Better Rich Results detection
- All schema types detected properly by Google
- Single source of truth

============================================================================
{% endcomment %}

{% assign schema_type = page.schema_type | default: include.type | default: "WebPage" %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": "{{ site.url }}{{ site.baseurl }}/#website",
      "url": "{{ site.url }}{{ site.baseurl }}/",
      "name": "{{ site.title }}",
      "description": "{{ site.description }}",
      "inLanguage": "{{ site.lang | default: 'id' }}",
      "publisher": {
        "@type": "Organization",
        "name": "{{ site.business.name }}",
        "@id": "{{ site.url }}{{ site.baseurl }}/#organization"
      }
    },
    {
      "@type": "Organization",
      "@id": "{{ site.url }}{{ site.baseurl }}/#organization",
      "name": "{{ site.business.name }}",
      "url": "{{ site.url }}{{ site.baseurl }}/",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ site.url }}{{ site.baseurl }}/assets/images/logo.png"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "{{ site.business.phone }}",
        "contactType": "Customer Service",
        "areaServed": "ID",
        "availableLanguage": "Indonesian"
      },
      "sameAs": [
        "{{ site.business.whatsapp_url }}"
      ]
    },
    {
      "@type": "SiteNavigationElement",
      "@id": "{{ site.url }}{{ site.baseurl }}/#navigation",
      "name": "Main Navigation",
      "hasPart": [
        {
          "@type": "WebPage",
          "@id": "{{ site.url }}{{ site.baseurl }}/#beranda",
          "name": "Beranda",
          "url": "{{ site.url }}{{ site.baseurl }}/"
        },
        {
          "@type": "WebPage",
          "@id": "{{ site.url }}{{ site.baseurl }}/product#produk",
          "name": "Produk",
          "url": "{{ site.url }}{{ site.baseurl }}/product"
        },
        {
          "@type": "WebPage",
          "@id": "{{ site.url }}{{ site.baseurl }}/blog#blog",
          "name": "Blog",
          "url": "{{ site.url }}{{ site.baseurl }}/blog"
        },
        {
          "@type": "WebPage",
          "@id": "{{ site.url }}{{ site.baseurl }}/tentang#tentang",
          "name": "Tentang Kami",
          "url": "{{ site.url }}{{ site.baseurl }}/tentang"
        },
        {
          "@type": "WebPage",
          "@id": "{{ site.url }}{{ site.baseurl }}/kontak#kontak",
          "name": "Kontak",
          "url": "{{ site.url }}{{ site.baseurl }}/kontak"
        }
      ]
    },
    {
      "@type": "{{ schema_type }}",
      "@id": "{{ page.url | absolute_url }}#webpage",
      "url": "{{ page.url | absolute_url }}",
      "name": "{{ page.title }}",
      "description": "{{ page.description | default: site.description | strip_html | strip_newlines | escape }}",
      "inLanguage": "{{ site.lang | default: 'id' }}",
      "isPartOf": {
        "@type": "WebSite",
        "@id": "{{ site.url }}{{ site.baseurl }}/#website",
        "url": "{{ site.url }}{{ site.baseurl }}/",
        "name": "{{ site.title }}"
      }{% if page.image %},
      "primaryImageOfPage": {
        "@type": "ImageObject",
        "url": "{{ page.image | absolute_url }}"
      }{% endif %}{% if page.date %},
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "dateModified": "{% if page.last_modified_at %}{{ page.last_modified_at | date_to_xmlschema }}{% else %}{{ page.date | date_to_xmlschema }}{% endif %}"{% endif %}
    }
  ]
}
</script>
