{% comment %}
  ============================================================================
  Cara Menghitung Block Component (Interactive Calculator)
  ============================================================================

  @file        _includes/components/tutorial/block--cara-menghitung.html
  @description Kalkulator interaktif untuk menghitung kebutuhan kayu dolken.
               Menyediakan form input dan menampilkan hasil perhitungan secara real-time.
               HARDCODED CALCULATOR - tidak menggunakan data dari frontmatter.

  @version     1.0.0
  @date        2025-11-21
  @author      jualkayudolkengelam

  Heading Structure (SEO & Accessibility):
  -----------------------------------------
  - 1 × H2: "Kalkulator Kebutuhan Dolken" (id="heading-25")
  - 1 × H3: "Jumlah Dolken yang Dibutuhkan" (id="heading-26", in result section)
  - 0 × H4, H5, H6: Not used in this block

  Total Headings: 2

  Features:
  ---------
  - Gradient header with calculator icon and H2 title
  - Interactive form with 2 input fields:
    - Total Panjang Pagar (meter)
    - Jarak Antar Tiang (meter)
  - Real-time validation (HTML5 required fields)
  - Calculate button with icon
  - Result display section with:
    - H3 heading for result
    - Calculated value (with decimals)
    - Rounded value badge
  - JavaScript calculator logic (formula: panjang ÷ jarak)
  - Smooth scroll to result
  - Responsive form layout (2-column on desktop, 1-column on mobile)

  Calculator Logic:
  -----------------
  Formula: Jumlah Dolken = Total Panjang Pagar ÷ Jarak Antar Tiang
  Example: 40 meter ÷ 1.5 meter = 26.67 batang → dibulatkan menjadi 27 batang

  Class Mapping (Semantic Classes):
  ----------------------------------
  - calculator-section-wrapper: Main wrapper
  - calculator-section-header-card: Header card container
  - calculator-form-card: Form card container
  - calculator-form: Form element
  - calculator-inputs-grid: Input fields grid
  - calculator-input-col: Input column wrapper
  - calculator-input-field: Input field
  - calculator-submit-btn: Submit button
  - calculator-result-wrapper: Result wrapper (initially hidden)
  - calculator-result-alert: Result alert box
  - calculator-rounded-result: Rounded result display

  Usage:
  ------
  IMPORTANT: This block is HARDCODED and does NOT use frontmatter data.
  Simply include the block in your content:

  <section id="cara-menghitung">
    {% include components/tutorial/block--cara-menghitung.html %}
  </section>

  ============================================================================
  NO YAML STRUCTURE NEEDED - HARDCODED CALCULATOR
  ============================================================================

  This block does NOT require frontmatter configuration. All content, labels,
  and calculation logic are hardcoded in the HTML and JavaScript.

  To customize this calculator:
  1. Edit the HTML directly in this file
  2. Modify input labels, placeholders, and validation messages
  3. Update calculation formula in JavaScript (line 120)
  4. Adjust result display format and styling

  ============================================================================
{% endcomment %}


<div class="my-5 calculator-section-wrapper">
  <!-- Section Header -->
  <div class="card border-0 calculator-section-header-card shadow-lg mb-4">
    <div class="card-body text-white text-center py-4" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);">
      <i class="bi bi-calculator-fill mb-2" style="font-size: 2.5rem;"></i>
      <h2 class="h2 mb-0 fw-bold text-white" id="heading-25">Kalkulator Kebutuhan Dolken</h2>
      <p class="mb-0 mt-2 small" style="opacity: 0.9;">Hitung kebutuhan dolken Anda secara otomatis</p>
    </div>
  </div>

  <!-- Calculator Form -->
  <div class="card border-0 calculator-form-card shadow-sm">
    <div class="card-body p-4">
      <form id="calculator-form" class="needs-validation calculator-form" novalidate="">
        <div class="row g-3 calculator-inputs-grid">
          
          <div class="col-12 col-sm-6 calculator-input-col">
            <label for="calc-panjang" class="form-label fw-bold">Total Panjang Pagar (meter)</label>
            <input type="number" class="form-control form-control-lg calculator-input-field" id="calc-panjang" name="panjang" placeholder="Contoh: 40" min="0" step="any" required="">
            <div class="invalid-feedback">
              Mohon isi total panjang pagar (meter)
            </div>
          </div>
          
          <div class="col-12 col-sm-6 calculator-input-col">
            <label for="calc-jarak" class="form-label fw-bold">Jarak Antar Tiang (meter)</label>
            <input type="number" class="form-control form-control-lg calculator-input-field" id="calc-jarak" name="jarak" placeholder="Contoh: 1.5" min="0" step="any" required="">
            <div class="invalid-feedback">
              Mohon isi jarak antar tiang (meter)
            </div>
          </div>
          
        </div>

        <div class="d-grid gap-2 mt-4">
          <button type="submit" class="btn btn-primary btn-lg calculator-submit-btn">
            <i class="bi bi-calculator me-2"></i>Hitung Sekarang
          </button>
        </div>
      </form>

      <!-- Result Display -->
      <div id="calculator-result" class="mt-4 d-none calculator-result-wrapper">
        <div class="alert alert-success border-0 shadow-sm calculator-result-alert" role="alert">
          <div class="d-flex align-items-center">
            <i class="bi bi-check-circle-fill fs-3 me-3"></i>
            <div class="flex-grow-1">
              <h3 class="h5 mb-1 fw-bold" id="heading-26">Jumlah Dolken yang Dibutuhkan</h3>
              <p class="mb-2 fs-4 fw-bold text-success" id="result-value">-</p>
              <div class="d-flex align-items-center gap-2 calculator-rounded-result">
                <span class="small text-muted">Dibulatkan menjadi:</span>
                <span class="badge bg-success fs-6 px-3 py-2" id="result-rounded">-</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(function() {
  const form = document.getElementById('calculator-form');
  const resultDiv = document.getElementById('calculator-result');
  const resultValue = document.getElementById('result-value');

  if (!form) return;

  form.addEventListener('submit', function(e) {
    e.preventDefault();

    if (!form.checkValidity()) {
      e.stopPropagation();
      form.classList.add('was-validated');
      return;
    }

    // Get form values
    const formData = new FormData(form);
    const values = {};
    for (let [key, value] of formData.entries()) {
      values[key] = parseFloat(value) || 0;
    }

    // Calculate result
    
    try {
      // Eval formula with values
      
      const result = values.panjang / values.jarak;
      const rounded = Math.ceil(result);

      // Display result with decimals
      resultValue.textContent = result.toLocaleString('id-ID', {
        minimumFractionDigits: 0,
        maximumFractionDigits: 3
      }) + ' batang';

      // Display rounded result
      const roundedElement = document.getElementById('result-rounded');
      if (roundedElement) {
        roundedElement.textContent = rounded.toLocaleString('id-ID') + ' batang';
      }

      resultDiv.classList.remove('d-none');

      // Scroll to result
      resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    } catch (error) {
      console.error('Calculation error:', error);
      resultValue.textContent = 'Error dalam perhitungan';
      resultDiv.classList.remove('d-none');
    }
    
  });
})();
</script>
