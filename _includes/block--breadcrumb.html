{% comment %}
============================================================================
Block Component: Breadcrumb (HTML + Schema)
============================================================================

@file        block--breadcrumb.html
@path        _includes/block--breadcrumb.html
@type        Block (component)
@description Breadcrumb navigation with Schema.org BreadcrumbList markup
@author      arisciwek

This component provides both visual breadcrumb navigation and structured
data for better SEO and Google Rich Results.

Parameters:
-----------
- items: (optional) array of breadcrumb items
  Each item should have:
  - name: Display text
  - url: Link URL

  If not provided, will use default structure:
  Beranda > Produk > Current Page

- current_title: (required if items not provided) Current page title
- parent_name: (optional) Parent section name (default: "Produk")
- parent_url: (optional) Parent section URL (default: "/#product")

Usage:
------
Basic (auto breadcrumb for product pages):
{% include block--breadcrumb.html current_title=page.title %}

Custom parent:
{% include block--breadcrumb.html
   current_title=page.title
   parent_name="Blog"
   parent_url="/blog/"
%}

Custom items:
{% assign breadcrumb_items = "
  [
    {\"name\": \"Beranda\", \"url\": \"/\"},
    {\"name\": \"Produk\", \"url\": \"/#product\"},
    {\"name\": \"" | append: page.title | append: "\", \"url\": \"" | append: page.url | append: "\"}
  ]
" %}
{% include block--breadcrumb.html items=breadcrumb_items %}

Features:
---------
- Bootstrap breadcrumb styling
- Schema.org BreadcrumbList in JSON-LD
- Responsive design
- Accessible (aria-label)
- SEO optimized

============================================================================
{% endcomment %}

{% comment %} Build breadcrumb items {% endcomment %}
{% if include.items %}
  {% assign breadcrumb_items = include.items %}
{% else %}
  {% comment %} Default breadcrumb structure {% endcomment %}
  {% assign parent_name = include.parent_name | default: "Produk" %}
  {% assign parent_url = include.parent_url | default: "/#product" %}
  {% assign current_title = include.current_title | default: page.title %}
  {% assign current_url = page.url %}
{% endif %}

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="mb-3">
  <ol class="breadcrumb">
    {% if include.items %}
      {% comment %} Custom items mode {% endcomment %}
      {% for item in breadcrumb_items %}
        {% if forloop.last %}
          <li class="breadcrumb-item active" aria-current="page">{{ item.name }}</li>
        {% else %}
          <li class="breadcrumb-item">
            <a href="{{ item.url | relative_url }}">{{ item.name }}</a>
          </li>
        {% endif %}
      {% endfor %}
    {% else %}
      {% comment %} Default mode {% endcomment %}
      <li class="breadcrumb-item">
        <a href="{{ '/' | relative_url }}">Beranda</a>
      </li>
      <li class="breadcrumb-item">
        <a href="{{ parent_url | relative_url }}">{{ parent_name }}</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">{{ current_title }}</li>
    {% endif %}
  </ol>
</nav>

<!-- Breadcrumb Schema (JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {% if include.items %}
      {% comment %} Custom items mode {% endcomment %}
      {% for item in breadcrumb_items %}
      {
        "@type": "ListItem",
        "position": {{ forloop.index }},
        "name": "{{ item.name }}",
        "item": "{{ item.url | absolute_url }}"
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    {% else %}
      {% comment %} Default mode {% endcomment %}
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Beranda",
        "item": "{{ site.url }}{{ site.baseurl }}/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ parent_name }}",
        "item": "{{ site.url }}{{ site.baseurl }}{{ parent_url }}"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "{{ current_title }}",
        "item": "{{ current_url | absolute_url }}"
      }
    {% endif %}
  ]
}
</script>
