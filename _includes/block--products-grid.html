{% comment %}
  ============================================================================
  Product Grid Component (Visual Only)
  ============================================================================

  @file        _includes/block--products-grid.html
  @description Product grid display for homepage with card layout, images,
               ratings, features, and custom order card.

  @version     1.0.0
  @date        2025-11-22
  @author      jualkayudolkengelam
  @copyright   2024-2025 Kayu Dolken Gelam - Amirudin Abdul Karim
  @license     All rights reserved

  Features:
  ---------
  - Responsive grid layout (3 columns on large, 2 on medium)
  - Product cards with images, ratings, features
  - WhatsApp order buttons
  - Custom order card for special requests
  - Info box with pricing disclaimer

  Parameters:
  -----------
  - title: Custom section heading (default: "Daftar Harga Kayu Dolken Gelam")
  - subtitle: Custom subtitle (default: "Panjang 4 Meter - Berbagai Ukuran Diameter")

  Usage:
  ------
  {% include block--products-grid.html %}

  {% include block--products-grid.html title="Produk Kami" %}

  Used in:
  --------
  - index.html (homepage products section)

  ============================================================================
{% endcomment %}

{% assign grid_title = include.title | default: "Daftar Harga Kayu Dolken Gelam" %}
{% assign grid_subtitle = include.subtitle | default: "Panjang 4 Meter - Berbagai Ukuran Diameter" %}

<div class="container">
  <div class="text-center mb-5">
    <h2 class="display-5 fw-bold text-wood mb-3">{{ grid_title }}</h2>
    <p class="lead text-muted">{{ grid_subtitle }}</p>
  </div>

  <div class="row g-4">
    {% assign sorted_products = site.products | sort: "price" %}
    {% for product in sorted_products %}
    <!-- {{ product.title }} -->
    <div class="col-lg-4 col-md-6">
      <div class="card product-card h-100{% if product.popular %} popular border-wood{% endif %}"{% if product.popular %} style="border-width: 2px;"{% endif %}>
        <a href="{{ product.url | relative_url }}" class="text-decoration-none">
          {% if product.image %}
          <picture>
            <source srcset="{{ product.image | replace: '.jpeg', '.webp' | relative_url }}" type="image/webp">
            <img src="{{ product.image | relative_url }}"
                 class="card-img-top"
                 alt="{{ product.title }}"
                 style="height: 200px; object-fit: cover;"
                 loading="lazy">
          </picture>
          {% endif %}
        </a>
        <div class="card-header text-center{% if product.popular %} bg-wood{% endif %}">
          {% if product.popular %}
          <i class="bi bi-star-fill me-2"></i>{{ product.diameter }}
          <span class="badge bg-warning text-dark ms-2">Populer</span>
          {% else %}
          <i class="bi bi-rulers me-2"></i>{{ product.diameter }}
          {% endif %}
        </div>
        <div class="card-body text-center">
          <div class="product-price mb-2">Rp {{ product.price | rupiah }}</div>
          <p class="text-muted mb-2">per batang (4 meter)</p>

          {% if product.rating or product.review_count %}
          <div class="mb-3 d-flex justify-content-center align-items-center gap-2">
            {% if product.rating %}
            <div class="text-warning">
              {% assign rating_rounded = product.rating | default: 4.5 | round %}
              {% for i in (1..5) %}
                {% if i <= rating_rounded %}
                  <i class="bi bi-star-fill"></i>
                {% else %}
                  <i class="bi bi-star"></i>
                {% endif %}
              {% endfor %}
            </div>
            {% endif %}
            {% if product.rating and product.review_count %}
            <span class="text-muted small">
              <strong>{{ product.rating }}</strong> ({{ product.review_count }} ulasan)
            </span>
            {% elsif product.review_count %}
            <span class="text-muted small">
              {{ product.review_count }} ulasan
            </span>
            {% endif %}
          </div>
          {% endif %}

          {% if product.features %}
          <ul class="list-unstyled text-start mb-4">
            {% for feature in product.features limit:4 %}
            <li class="mb-2"><i class="bi bi-check-circle-fill text-success me-2"></i>{{ feature }}</li>
            {% endfor %}
          </ul>
          {% endif %}
          <a href="{{ product.url | relative_url }}" class="btn btn-wood w-100 mb-2">
            <i class="bi bi-info-circle me-2"></i>Lihat Detail
          </a>
          <a href="https://wa.me/{{ site.business.whatsapp }}?text=Halo,%20saya%20ingin%20pesan%20{{ product.title }}%20-%20Rp%20{{ product.price }}" class="btn btn-outline-success w-100" target="_blank">
            <i class="bi bi-whatsapp me-2"></i>Pesan Sekarang
          </a>
        </div>
      </div>
    </div>
    {% endfor %}

    <!-- Custom Order -->
    <div class="col-lg-4 col-md-6">
      <div class="card product-card h-100 bg-light">
        <div class="card-header text-center bg-secondary text-white">
          <i class="bi bi-chat-dots me-2"></i>Custom Order
        </div>
        <div class="card-body text-center d-flex flex-column justify-content-center">
          <i class="bi bi-telephone-fill text-wood mb-3" class="fs-3rem"></i>
          <h5 class="mb-3">Butuh Ukuran Khusus?</h5>
          <p class="text-muted mb-4">Hubungi kami untuk pesanan custom sesuai kebutuhan proyek Anda</p>
          <a href="https://wa.me/{{ site.business.whatsapp }}?text=Halo,%20saya%20ingin%20konsultasi%20pesanan%20custom" class="btn btn-outline-wood w-100" target="_blank">
            <i class="bi bi-whatsapp me-2"></i>Konsultasi Gratis
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Info Box -->
  <div class="row mt-5">
    <div class="col-12">
      <div class="alert alert-info border-0 shadow-sm">
        <div class="row align-items-center">
          <div class="col-md-8">
            <h5 class="alert-heading"><i class="bi bi-info-circle me-2"></i>Informasi Penting</h5>
            <p class="mb-0">Harga dapat berubah sewaktu-waktu. Minimal pemesanan dan biaya pengiriman akan dihitung berdasarkan lokasi tujuan. Hubungi kami untuk informasi lebih detail dan penawaran terbaik.</p>
          </div>
          <div class="col-md-4 text-md-end mt-3 mt-md-0">
            <a href="{{ '/kontak' | relative_url }}" class="btn btn-primary">
              <i class="bi bi-envelope me-2"></i>Hubungi Kami
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
