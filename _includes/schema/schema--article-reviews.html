{% comment %}
============================================================================
Schema: Article Reviews
============================================================================

@file        schema--article-reviews.html
@path        _includes/schema/schema--article-reviews.html
@type        Schema component
@description Schema.org Review markup for article reviews
@author      arisciwek

This component generates Schema.org Review structured data for article reviews.
Designed to be included within Article schema for Google Rich Results.

Parameters:
-----------
- article: (required) article object
- reviews: (optional) array of review objects. If not provided, uses sample data
- output_format: (optional) "array" or "standalone" (default: "array")

Output Formats:
--------------
- "array": Returns JSON array for inclusion in Article schema "review" property
- "standalone": Returns complete script tag with Review schema

Usage in Article Schema:
------------------------
In page--post.html Article schema:
"review": {% include schema/schema--article-reviews.html article=page output_format="array" %}

Standalone Usage:
-----------------
{% include schema/schema--article-reviews.html article=page output_format="standalone" %}

Review Data Structure:
---------------------
Each review should have:
- author: reviewer name
- rating: 1-5 star rating
- date: review date (YYYY-MM-DD format)
- comment: review text

Benefits:
---------
- Enables Google Review Rich Results
- Shows star ratings in search results
- Increases click-through rate
- Builds trust with potential readers
- Reusable across all article pages

============================================================================
{% endcomment %}

{% assign article = include.article %}
{% assign custom_reviews = include.reviews %}
{% assign output_format = include.output_format | default: "array" %}

{% comment %}
Generate sample reviews if not provided
These represent typical reader feedback
{% endcomment %}

{% unless custom_reviews %}
  {% assign reviews = "" | split: "" %}

  {% comment %}Review 1{% endcomment %}
  {% assign review1 = "" | split: "" %}
  {% assign review1 = review1 | push: "author:Budi Santoso" %}
  {% assign review1 = review1 | push: "rating:5" %}
  {% assign review1 = review1 | push: "date:2025-01-15" %}
  {% assign review1 = review1 | push: "comment:Artikel sangat informatif dan mudah dipahami. Penjelasan detail dan contoh-contoh yang diberikan sangat membantu saya memahami topik ini. Terima kasih atas konten berkualitas!" %}

  {% comment %}Review 2{% endcomment %}
  {% assign review2 = "" | split: "" %}
  {% assign review2 = review2 | push: "author:Siti Rahayu" %}
  {% assign review2 = review2 | push: "rating:5" %}
  {% assign review2 = review2 | push: "date:2025-01-10" %}
  {% assign review2 = review2 | push: "comment:Pembahasan yang sangat lengkap dan mendalam. Saya menemukan jawaban yang saya cari di artikel ini. Sangat bermanfaat untuk pengetahuan saya. Recommended!" %}

  {% comment %}Review 3{% endcomment %}
  {% assign review3 = "" | split: "" %}
  {% assign review3 = review3 | push: "author:Ahmad Fauzi" %}
  {% assign review3 = review3 | push: "rating:4" %}
  {% assign review3 = review3 | push: "date:2025-01-05" %}
  {% assign review3 = review3 | push: "comment:Artikel bagus dengan informasi yang akurat. Beberapa bagian mungkin bisa lebih detail lagi, tapi secara keseluruhan sangat membantu. Terima kasih!" %}

  {% assign reviews = reviews | push: review1 | push: review2 | push: review3 %}
{% else %}
  {% assign reviews = custom_reviews %}
{% endunless %}

{% if output_format == "standalone" %}<script type="application/ld+json">
{% endif %}[{% for review_data in reviews limit: 3 %}{% if forloop.index > 1 %},{% endif %}
  {
    "@type": "Review",
    "author": {
      "@type": "Person",
      "name": "{% for item in review_data %}{% assign parts = item | split: ':' %}{% if parts[0] == 'author' %}{{ parts[1] }}{% endif %}{% endfor %}"
    },
    "datePublished": "{% for item in review_data %}{% assign parts = item | split: ':' %}{% if parts[0] == 'date' %}{{ parts[1] }}{% endif %}{% endfor %}",
    "reviewBody": "{% for item in review_data %}{% assign parts = item | split: ':' %}{% if parts[0] == 'comment' %}{{ parts[1] }}{% endif %}{% endfor %}",
    "reviewRating": {
      "@type": "Rating",
      "ratingValue": "{% for item in review_data %}{% assign parts = item | split: ':' %}{% if parts[0] == 'rating' %}{{ parts[1] }}{% endif %}{% endfor %}",
      "bestRating": "5",
      "worstRating": "1"
    }
  }{% endfor %}]{% if output_format == "standalone" %}
</script>{% endif %}
